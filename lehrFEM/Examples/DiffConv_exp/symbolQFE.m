function S=symbolQFE(stencil1,stencil2, stencil3, stencil4,perclet,k1,k2);

M=exp(perclet*[-k1 + k2, -k1 + k2, k2, k2, k1 + k2;...
    -k1, -k1, zeros(size(k1)), zeros(size(k1)), k1;...
    -k1, -k1, zeros(size(k1)), zeros(size(k1)), k1;...
    -k1 - k2, -k1 - k2, -k2, -k2, k2;...
    -k1 - k2, -k1 - k2, -k2, -k2, k2]);

c1=M.*stencil1;
c2=M.*stencil2;
c3=M.*stencil3;
c4=M.*stencil4;

S=[sum(sum(c1([1, 3, 5], [1, 3, 5]))) sum(sum(c1([2, 3], [1, 3, 5]))) ...
    sum(sum(c1([1, 3, 5], [2, 4]))) sum(sum(c1([2, 4], [2, 4]))); ...
    sum(sum(c2([1, 3, 5], [1, 3, 5]))) sum(sum(c2([2, 3], [1, 3, 5]))) ...
    sum(sum(c2([1, 3, 5], [2, 4]))) sum(sum(c2([2, 4], [2, 4]))); ...
    sum(sum(c3([1, 3, 5], [1, 3, 5]))) sum(sum(c3([2, 3], [1, 3, 5]))) ...
    sum(sum(c3([1, 3, 5], [2, 4]))) sum(sum(c3([2, 4], [2, 4]))); ...
    sum(sum(c4([1, 3, 5], [1, 3, 5]))) sum(sum(c4([2, 3], [1, 3, 5]))) ...
    sum(sum(c4([1, 3, 5], [2, 4]))) sum(sum(c4([2, 4], [2, 4])))];
    